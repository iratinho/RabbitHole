option(FMT_SOURCE "Build with fmt sources" OFF)

if(FMT_SOURCE)
    message("Building with FMT")
    add_subdirectory(${LIBRARIES_DIRECTORY}/fmt ${CMAKE_BINARY_DIR}/fmt)
    target_link_libraries(${TARGET_NAME} PUBLIC fmt::fmt)
else()
    message("Using FMT")
    execute_process(COMMAND ${CMAKE_COMMAND} --install . --config ${CMAKE_BUILD_TYPE} WORKING_DIRECTORY ${LIBRARIES_DIRECTORY}/.build/fmt RESULT_VARIABLE outt)
    find_package(fmt CONFIG REQUIRED PATHS ${CMAKE_BINARY_DIR}/generated_install/lib/cmake/fmt/)
    target_link_libraries(${TARGET_NAME} PRIVATE fmt::fmt)
    target_include_directories(${TARGET_NAME} PRIVATE ${CMAKE_BINARY_DIR}/generated_install)
endif()
