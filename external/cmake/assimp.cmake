option(ASSIMP_SOURCE "Build with assimp sources" OFF)

if(ASSIMP_SOURCE)
    message("Building with ASSIMP")
    set(CMAKE_POLICY_DEFAULT_CMP0077 NEW)
    set(ASSIMP_WARNINGS_AS_ERRORS OFF)
    add_subdirectory(${LIBRARIES_DIRECTORY}/assimp ${CMAKE_BINARY_DIR}/assimp)
    target_link_libraries(${TARGET_NAME} PRIVATE assimp)
else()
    message("Using ASSIMP")
    execute_process(COMMAND ${CMAKE_COMMAND} --install . --config ${CMAKE_BUILD_TYPE} WORKING_DIRECTORY ${LIBRARIES_DIRECTORY}/.build/assimp RESULT_VARIABLE outt)    
    find_package(assimp CONFIG REQUIRED PATHS ${CMAKE_BINARY_DIR}/generated_install/lib/cmake/assimp-5.2/)
    target_link_libraries(${TARGET_NAME} PRIVATE assimp::assimp)
    target_include_directories(${TARGET_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR})
endif()